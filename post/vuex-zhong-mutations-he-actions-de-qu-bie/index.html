<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>Vuexä¸­mutationså’Œactionsçš„åŒºåˆ« | cutezhangq</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://cutezhangq.github.io/favicon.ico?v=1599572321133">
<link rel="stylesheet" href="https://cutezhangq.github.io/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="ğŸ‘‰Vuex æ˜¯ä¸€ä¸ªä¸“ä¸º Vue.js åº”ç”¨ç¨‹åºå¼€å‘çš„çŠ¶æ€ç®¡ç†æ¨¡å¼ã€‚ğŸ‘ˆ
å®ƒé‡‡ç”¨é›†ä¸­å¼å­˜å‚¨ç®¡ç†åº”ç”¨çš„æ‰€æœ‰ç»„ä»¶çš„çŠ¶æ€ï¼Œå¹¶ä»¥ç›¸åº”çš„è§„åˆ™ä¿è¯çŠ¶æ€ä»¥ä¸€ç§å¯é¢„æµ‹çš„æ–¹å¼å‘ç”Ÿå˜åŒ–ğŸ™†ğŸ™†ğŸ™†

Mutation
Mutation æ›´æ”¹ Vuex çš„ st..." />
    <meta name="keywords" content="vue" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://cutezhangq.github.io">
        <img src="https://cutezhangq.github.io/images/avatar.png?v=1599572321133" class="site-logo">
        <h1 class="site-title">cutezhangq</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
          <a class="social-link" href="https://github.com/cutezhangq" target="_blank">
            <i class="fab fa-github"></i>
          </a>
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      æ¸©æ•…çŸ¥æ–°
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://cutezhangq.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">Vuexä¸­mutationså’Œactionsçš„åŒºåˆ«</h2>
            <div class="post-date">2020-05-22</div>
            
              <div class="feature-container" style="background-image: url('https://cutezhangq.github.io/post-images/vuex-zhong-mutations-he-actions-de-qu-bie.jpg')">
              </div>
            
            <div class="post-content" v-pre>
              <p>ğŸ‘‰<strong>Vuex</strong> æ˜¯ä¸€ä¸ªä¸“ä¸º Vue.js åº”ç”¨ç¨‹åºå¼€å‘çš„çŠ¶æ€ç®¡ç†æ¨¡å¼ã€‚ğŸ‘ˆ<br>
å®ƒé‡‡ç”¨é›†ä¸­å¼å­˜å‚¨ç®¡ç†åº”ç”¨çš„æ‰€æœ‰ç»„ä»¶çš„çŠ¶æ€ï¼Œå¹¶ä»¥ç›¸åº”çš„è§„åˆ™ä¿è¯çŠ¶æ€ä»¥ä¸€ç§å¯é¢„æµ‹çš„æ–¹å¼å‘ç”Ÿå˜åŒ–ğŸ™†ğŸ™†ğŸ™†</p>
<!-- more -->
<h1 id="mutation">Mutation</h1>
<p>Mutation æ›´æ”¹ Vuex çš„ store ä¸­çš„çŠ¶æ€çš„<strong>å”¯ä¸€</strong>æ–¹æ³•æ˜¯æäº¤ mutationã€‚äº‹å®ä¸Šåœ¨ vuex é‡Œé¢ actions åªæ˜¯ä¸€ä¸ªæ¶æ„æ€§çš„æ¦‚å¿µï¼Œå¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œåªè¦æœ€åè§¦å‘ mutation å°±è¡Œã€‚å¼‚æ­¥ç«æ€æ€ä¹ˆå¤„ç†é‚£æ˜¯ç”¨æˆ·è‡ªå·±çš„äº‹æƒ…ã€‚</p>
<h1 id="action">Action</h1>
<ul>
<li>
<p>Action <strong>æäº¤çš„æ˜¯ mutation</strong>ï¼Œè€Œä¸æ˜¯ç›´æ¥å˜æ›´çŠ¶æ€ã€‚æœ€å<strong>æ˜¯mutationå»ä¿®æ”¹storeé‡Œçš„state</strong></p>
</li>
<li>
<p>Action å¯ä»¥åŒ…å«ä»»æ„<strong>å¼‚æ­¥</strong>æ“ä½œã€‚</p>
</li>
<li>
<p><strong>mutationåªèƒ½è¿›è¡ŒåŒæ­¥æ“ä½œ</strong>ã€‚ä¸ºä»€ä¹ˆï¼Ÿè¯·å‚è€ƒä¸‹é¢çš„ä¾‹å­ï¼š</p>
</li>
</ul>
<pre><code class="language-js">mutations: {
 someMutation (state) {
   api.callAsyncMethod(() =&gt; {
     state.count++
   })
 }
}
</code></pre>
<p>ç°åœ¨æƒ³è±¡ï¼Œæˆ‘ä»¬æ­£åœ¨ debug ä¸€ä¸ª app å¹¶ä¸”è§‚å¯Ÿ devtool ä¸­çš„ mutation æ—¥å¿—ã€‚æ¯ä¸€æ¡ mutation è¢«è®°å½•ï¼Œdevtools éƒ½éœ€è¦æ•æ‰åˆ°å‰ä¸€çŠ¶æ€å’Œåä¸€çŠ¶æ€çš„å¿«ç…§ã€‚<br>ç„¶è€Œï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ mutation ä¸­çš„å¼‚æ­¥å‡½æ•°ä¸­çš„å›è°ƒè®©è¿™ä¸å¯èƒ½å®Œæˆï¼šå› ä¸ºå½“ mutation è§¦å‘çš„æ—¶å€™ï¼Œå›è°ƒå‡½æ•°è¿˜æ²¡æœ‰è¢«è°ƒç”¨ï¼Œ<br>devtools ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™å›è°ƒå‡½æ•°å®é™…ä¸Šè¢«è°ƒç”¨â€”â€”å®è´¨ä¸Šä»»ä½•åœ¨å›è°ƒå‡½æ•°ä¸­è¿›è¡Œçš„çŠ¶æ€çš„æ”¹å˜éƒ½æ˜¯ä¸å¯è¿½è¸ªçš„ã€‚</p>
<p>mutationçš„è§¦å‘é€šè¿‡store.commitæ¥è¿›è¡Œ</p>
<p>actionçš„è§¦å‘é€šè¿‡store.dispatchè¿›è¡Œ</p>
<h1 id="å®‰è£…">å®‰è£…</h1>
<blockquote>
<p>npm install vuex --save</p>
</blockquote>
<h1 id="ç”¨æ³•ä¸€">ç”¨æ³•ä¸€</h1>
<pre><code class="language-js">
/**
 * åˆ›å»ºå®Œæ–‡ä»¶åéœ€è¦å»åˆ°main.jsä¸­å¼•å…¥æˆå…¨å±€
 */
import Vue from &quot;vue&quot;;
import Vuex from &quot;vuex&quot;;
//ä½¿ç”¨vuex
Vue.use(Vuex);
const state = {
  targetUser: {} //ç”¨æˆ·è¯¦ç»†èµ„æ–™æ•°æ®
};
 
const getters = {
  //è·å–åˆ°ç”¨æˆ·çŠ¶æ€,//å®æ—¶ç›‘å¬stateå€¼çš„å˜åŒ–(æœ€æ–°çŠ¶æ€)
  targetUser: state =&gt; state.targetUser
};
 
const mutations = {
  //è‡ªå®šä¹‰æ”¹å˜stateåˆå§‹å€¼çš„æ–¹æ³•
  SET_TARGET_USER(state, targetUser) {
    if (targetUser) {
      state.targetUser = targetUser; //å¦‚æœtargetUseræœ‰å†…å®¹å°±èµ‹ç»™çŠ¶æ€ä¿¡æ¯
    } else {
      //å¦‚æœæ²¡å†…å®¹å°±ç»™targetUserèµ‹ç©ºå¯¹è±¡
      state.targetUser = {};
    }
  }
};
 
const actions = {
  //è¿™é‡Œé¢çš„æ–¹æ³•æ˜¯ç”¨æ¥å¼‚æ­¥è§¦å‘mutationsé‡Œé¢çš„æ–¹æ³•,contextä¸store å®ä¾‹å…·æœ‰ç›¸åŒæ–¹æ³•å’Œå±æ€§
  // é¡µé¢å®šä¹‰çš„setGargetUser,targetUserä¸ºé¡µé¢ä¼ è¿‡æ¥çš„å€¼
  setGargetUser({ commit }, targetUser) {
    commit(&quot;SET_TARGET_USER&quot;, targetUser);
  }
};
</code></pre>
<p>å­˜å‚¨é¡µé¢:</p>
<pre><code class="language-js">
this.$store.dispatch('setGargetUser',friend)
</code></pre>
<p>è·å–é¡µé¢:</p>
<pre><code class="language-js"> computed:{
        //  æç¤ºvuexä¸­å­˜å…¥çš„ç”¨æˆ·è¯¦ç»†èµ„æ–™
        targetUser(){
            return this.$store.getters.targetUser
        }
     },
</code></pre>
<p>ä»¥ä¸Šæ–¹æ³•æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯å¦‚æœå¤šäººå¼€å‘;ä¼šå‡ºç°ä¸åˆ©äºç®¡ç†,ä¸‹é¢ç”¨ä¸€ä¸ªæ–¹æ³•å®šä¹‰ä¸€ä¸ªå¸¸é‡<br>
å­˜å‚¨:</p>
<pre><code class="language-js">  this.$store.dispatch('setUser',decode)
</code></pre>
<p>store.js</p>
<pre><code class="language-js">
/**
 * åˆ›å»ºå®Œæ–‡ä»¶åéœ€è¦å»åˆ°main.jsä¸­å¼•å…¥æˆå…¨å±€
 */
import Vue from &quot;vue&quot;;
import Vuex from &quot;vuex&quot;;
// æŒä¹…å­˜å‚¨æ’ä»¶
import createPersistedState from &quot;vuex-persistedstate&quot;;
 
//ä½¿ç”¨vuex
Vue.use(Vuex);
 
/**
 * åœ¨éœ€è¦å¤šäººåä½œçš„é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¸¸é‡ä»£æ›¿mutation äº‹ä»¶ç±»å‹ã€‚è¿™åœ¨å„ç§ Flux å®ç°ä¸­æ˜¯å¾ˆå¸¸è§çš„æ¨¡å¼ã€‚åŒæ—¶æŠŠè¿™äº›å¸¸é‡æ”¾åœ¨å•ç‹¬çš„æ–‡ä»¶ä¸­å¯ä»¥è®©åä½œå¼€å‘å˜å¾—æ¸…æ™°ã€‚
 *  å®šä¹‰å­˜å‚¨ä¿¡æ¯
 *
 *    */
 
const types = {
  SET_TARGET_USER: &quot;SET_TARGET_USER&quot; //è¯¦ç»†èµ„æ–™
};
 
const state = {
  //ç”¨æˆ·åˆå§‹åŒ–çš„çŠ¶æ€
  targetUser: {} //ç”¨æˆ·è¯¦ç»†èµ„æ–™æ•°æ®
};
const getters = {
  //è·å–åˆ°ç”¨æˆ·çŠ¶æ€,//å®æ—¶ç›‘å¬stateå€¼çš„å˜åŒ–(æœ€æ–°çŠ¶æ€)
  targetUser: state =&gt; state.targetUser
};
const mutations = {
  //è‡ªå®šä¹‰æ”¹å˜stateåˆå§‹å€¼çš„æ–¹æ³•
 
  [types.SET_TARGET_USER](state, targetUser) {
    if (targetUser) {
      state.targetUser = targetUser; //å¦‚æœtargetUseræœ‰å†…å®¹å°±èµ‹ç»™çŠ¶æ€ä¿¡æ¯
    } else {
      //å¦‚æœæ²¡å†…å®¹å°±ç»™targetUserèµ‹ç©ºå¯¹è±¡
      state.targetUser = {};
    }
  }
};
 
const actions = {
  //è¿™é‡Œé¢çš„æ–¹æ³•æ˜¯ç”¨æ¥å¼‚æ­¥è§¦å‘mutationsé‡Œé¢çš„æ–¹æ³•,contextä¸store å®ä¾‹å…·æœ‰ç›¸åŒæ–¹æ³•å’Œå±æ€§
  setGargetUser({ commit }, targetUser) {
    commit(types.SET_TARGET_USER, targetUser);
    // localStorage.setItem(&quot;SET_TARGET_USER&quot;, JSON.stringify(targetUser));
  }
};
export default new Vuex.Store({
  state,
  mutations,
  getters,
  actions,
});

</code></pre>
<p>å–å€¼:</p>
<pre><code class="language-js">this.$store.getters.targetUser
</code></pre>
<p>æƒ³è¦è·å–å¯¹åº”çš„çŠ¶æ€ä½ å°±å¯ä»¥ç›´æ¥ä½¿ç”¨this.$store.stateè·å–ï¼Œå½“ç„¶ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨vuexæä¾›çš„mapStateè¾…åŠ©å‡½æ•°å°†stateæ˜ å°„åˆ°è®¡ç®—å±æ€§ä¸­å»ï¼Œå¦‚.</p>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://cutezhangq.github.io/tag/3SsurU03A/" class="tag">
                    vue
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://cutezhangq.github.io/post/thisapplycallbind/">
                  <h3 class="post-title">
                    thisã€applyã€callã€bind
                  </h3>
                </a>
              </div>
            

            
              
                <div id="gitalk-container" data-aos="fade-in"></div>
              

              
            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>




  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: '',
        clientSecret: '',
        repo: '',
        owner: '',
        admin: [''],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
